bool TrySetMicaBackdrop(bool useMicaAlt)
{
    if (Microsoft.UI.Composition.SystemBackdrops.MicaController.IsSupported())
    {
        Microsoft.UI.Xaml.Media.MicaBackdrop micaBackdrop = new Microsoft.UI.Xaml.Media.MicaBackdrop();
        micaBackdrop.Kind = useMicaAlt ? Microsoft.UI.Composition.SystemBackdrops.MicaKind.BaseAlt : Microsoft.UI.Composition.SystemBackdrops.MicaKind.Base;
        this.SystemBackdrop = micaBackdrop;

        return true; // succeeded
    }

    return false; // Mica is not supported on this system
}